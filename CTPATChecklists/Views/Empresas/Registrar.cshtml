@model CTPATChecklists.Models.ViewModels.EmpresaRegistroViewModel

@{
    ViewData["Title"] = "Registrar Nueva Empresa";
}

<!-- Bootstrap 5 + Icons -->
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">

<style>
    .form-section {
        background-color: #ffffff;
        padding: 2rem;
        border-radius: 1rem;
        box-shadow: 0 4px 20px rgba(0, 0, 0, 0.1);
        margin-bottom: 2rem;
    }

    .form-title {
        font-size: 1.4rem;
        font-weight: bold;
        color: #0047ab;
        margin-bottom: 1rem;
    }

    label {
        margin-top: 1rem;
    }

    .preview-logo {
        max-width: 120px;
        margin-top: 1rem;
        display: none;
    }

    .btn-success {
        background-color: #28a745;
        border: none;
    }

        .btn-success:hover {
            background-color: #218838;
        }
</style>

<div class="container mt-5 mb-5">
    <h2 class="text-center mb-4">@ViewData["Title"]</h2>

    @if (TempData["Success"] != null)
    {
        <div class="alert alert-success">@TempData["Success"]</div>
    }

    @if (!ViewData.ModelState.IsValid)
    {
        <div class="alert alert-danger">
            @foreach (var error in ViewData.ModelState.Values.SelectMany(v => v.Errors))
            {
                <div>@error.ErrorMessage</div>
            }
        </div>
    }

    <form asp-action="Registrar" enctype="multipart/form-data" method="post">
        <div class="form-section">
            <div class="form-title"><i class="bi bi-person-fill"></i> Datos del Administrador</div>
            <input asp-for="AdminEmail" class="form-control mb-2" placeholder="Correo electrónico" />
            <input asp-for="AdminPassword" type="password" class="form-control" placeholder="Contraseña" />
        </div>

        <div class="form-section">
            <div class="form-title"><i class="bi bi-building"></i> Datos de la Empresa</div>
            <input asp-for="CompanyName" class="form-control mb-2" placeholder="Nombre" />
            <input asp-for="CompanyAddress" class="form-control mb-2" placeholder="Dirección" />
            <input asp-for="Phone" class="form-control mb-2" placeholder="Teléfono" />
            <input asp-for="Email" class="form-control" placeholder="Correo de contacto" />
        </div>

        <div class="form-section">
            <div class="form-title"><i class="bi bi-brush"></i> Personalización (Branding)</div>

            <label>Logo de la empresa</label>
            <input asp-for="LogoUpload" type="file" class="form-control" accept="image/*" onchange="previewLogo(event)" />
            <img id="logoPreview" class="preview-logo img-thumbnail" alt="Vista previa del logo" />

            <label>Color primario</label>
            <input asp-for="PrimaryColor" type="color" class="form-control" />

            <label>Color secundario</label>
            <input asp-for="SecondaryColor" type="color" class="form-control" />

            <label>Color del texto</label>
            <input asp-for="FontColor" type="color" class="form-control" />

            <label>Tipografía</label>
            <select asp-for="FontFamily" class="form-control">
                <option value="Arial, sans-serif">Arial</option>
                <option value="Helvetica, sans-serif">Helvetica</option>
                <option value="Georgia, serif">Georgia</option>
                <option value="'Roboto', sans-serif">Roboto</option>
            </select>
        </div>

        <div class="text-center">
            <button class="btn btn-success px-4 py-2">Registrar Empresa</button>
        </div>
    </form>
</div>

<script>
    function previewLogo(event) {
        const input = event.target;
        const preview = document.getElementById('logoPreview');
        if (input.files && input.files[0]) {
            const reader = new FileReader();
            reader.onload = function (e) {
                preview.src = e.target.result;
                preview.style.display = 'block';
            };
            reader.readAsDataURL(input.files[0]);
        } else {
            preview.src = "";
            preview.style.display = 'none';
        }
    }
</script>
